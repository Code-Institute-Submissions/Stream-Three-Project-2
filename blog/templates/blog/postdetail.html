{% extends "base.html" %}
{% block title %}Blog - {{ post.title }}{% endblock %}
{% load static %}
{% load disqus_tags %}
{% set_disqus_title post.title %}
{% disqus_show_comments %}
{% load cloudinary %}
{% block auxmenu %}
  {% if user.is_authenticated and user.is_staff %}
    <div class="container d-flex justify-content-end">
      <a class="btn btn-outline-success mx-2 my-2" href="{% url 'blog:newpost' %}">New Post</a>
    </div>
  {% endif %}
{% endblock %}
{% block content %}
  <div class="row blog">
    <div class="container blog-detail">
      <div class="row">
        <div class="col-12 d-f justify-content-center">
          {% if post.image %}
            <img class="featured-img col-12 mx-auto" src="{{post.image.url}}" style="display: block; max-width:400px; max-height:400px; width: auto; height: auto;">
          {% endif %}
          <h2 class="text-center mt-3">{{ post.title }}</h2>
          <p class="meta-data text-center lead">post by <strong>{{post.author}}</strong> on {{ post.published_date }} | <strong>Views</strong> {{ post.views }} | <strong>Tag</strong> {{ post.tag }}</p>
          {{ post.content|safe }}
          <p class="text-center">
            <a class="btn btn-outline-primary" href='{% url "blog:postlist" %}'">Back To Blog</a>
            {% if user.is_authenticated and user == post.author %}
            <a class="btn btn-outline-primary" href="{% url 'blog:editpost' post.id %}">Edit</a>
            <button id="del_post_btn" class="btn btn-outline-danger" post.id %}'">Delete</button>
            <form id="del_post_confirm" style="display: none;">
              {% csrf_token %}
              <div>
                <p><strong>Caustion</strong>: Are you sure you want to delete this post?</p>
                <button id='del_no' class="btn btn-success">No</button>
                <button id='del_yes' class="btn btn-danger">Yes</button>
              </div>
            </form>
            {% endif %}
          </p>  
        </div>
      </div>
    </div>
  </div>

  <div id="disqus_thread"></div>
  <script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    
    var disqus_config = function () {
      // this.page.url = window.location.url;  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = window.location.pathname; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://blog-comment.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
{% endblock %}
{% block aux %}
  <script src="{% static 'js/blog.js' %}"></script>
{% endblock %}